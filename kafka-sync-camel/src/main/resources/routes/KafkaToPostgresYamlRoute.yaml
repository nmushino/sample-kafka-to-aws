- route:
    id: route-graphql-contract
    from:
      uri: kafka:server.system.contract
      steps:
        - log:
            message: "Kafka Message Received: ${body}"
            loggingLevel: INFO

        - unmarshal:
            json:
              library: jackson

        - log:
            message: "Unmarshalled JSON: ${body}"
            loggingLevel: DEBUG

        - set-header:
            name: Content-Type
            constant: application/json

        - set-body:
            simple: >
              {
                "query": "mutation {
                  createContract(contractInput: {
                    contractId: \"${body[contractId]}\",
                    customerId: \"${body[customerId]}\",
                    productId: \"${body[productId]}\",
                    price: ${body[price]},
                    quantity: ${body[quantity]},
                    cancelFlg: \"${body[cancelFlg]}\",
                    createDate: \"${body[createDate]}\",
                    updateDate: \"${body[updateDate]}\"
                  }) {
                    contractId
                  }
                }"
              }

        - log:
            message: "GraphQL Request Body: ${body}"
            loggingLevel: DEBUG

        - to: http://reactivesample-sample-demo.apps.tggus-demo2.j526.p1.openshiftapps.com/graphql